---
title: "assignment_4"
author: "Alyssa Kibbe"
date: "11/13/2020"
output: html_document
---
# Exoloration of Snowshoe Hares
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(tidyverse)
library(here)
library(lubridate)
library(kableExtra)
library(effsize)
library(broom)
library(ggpubr)
```
## Introduction : 
#### The study of snowshoe hares at five locations in the Tanana Valley hoped to look at comparisons in populations over the five year testing period. It is known that snowshoe hares population have large fluctuations every 8-11 years. This study hoped to produce qualitiative data while observing the same populations over multiple years. The experimental variables included sex, age, weight (gm), hind foot length (mm), animal identifer, study type, and any unique notes on the individual hare.
```{r}
hares <- read.csv(here("data", "bonanza_hares.csv"))
```


```{r}
juvenile <- hares %>%
  filter(age == "j") %>% 
  mutate(date_new = mdy(date)) %>% 
  mutate(year = year(date_new)) %>% 
  mutate(day = day(date_new))

juvenile_per_year <- juvenile %>% 
  group_by(year) %>% 
  summarize(count_per_year = n())

ggplot(juvenile_per_year, aes(x =  year, y = count_per_year))+
  geom_col(fill = "goldenrod3",
          color = "goldenrod4" )+
  labs( x = "", y = "Hare Count", 
        title = "Variation in Juvenile Hare Count from 1999 to 2012")+
  theme_bw()


```


##### **Figure 1: Count of juvenile snowshoe hares over a 13 year period.** Populations counted at five sites along Bonanza Riparian zone on the Tanana River. 2002 and 2009 are excluded from the data set.  

### As seen in Figure 1, there is large variation in the snowshoe hare populations (min = 2 (2010), max = 126 (1999)). The overall trend of the data is skewed to the right. The mean number of snowshoe hare is 31 individuals counted per year. Median = 18.5. There are inconsistencies in the data that may have influences the results. In 2000, data was collected on 11 different days while in 2012, data was only collected on 2 days. For future collections, it would be beneficial to have a consistent number of sampling days each year.      

```{r}
# juvenile weights
ggplot(data = juvenile, aes(x = grid, y = weight))+
  geom_boxplot(aes(color = sex), )+
  labs(x = "Sample Site", y = "Weight (grams)", title = "Juvenile Snowshoe Hare Weight at Three Sampling Sites", colour = "Sex")+
  theme_bw()
```

##### **Figure 2: Variation in weight between males and females at three sampling sites.** "bonbs" is  the sampling site consisting of lowland black spruce, "bonmat" or Bonanza Mature is a forested area filled with mature tree species. "bonrip" or Bonanza Riparian is the flood zone from the Tanana River. NA represents individuals with unidentified sex.

```{r}
ggplot(data = juvenile, aes(x = grid, y = weight))+
  geom_jitter(aes(color = grid), alpha = 0.7)+
  labs(x = "Sample Site", y = "Weight (grams)", title = "Juvenile Snowshoe Hare Weight Distribution by Sex", colour = "Sampling Site")+
  facet_wrap(~sex)+
  theme_bw()
```



##### **Figure 3: Weight distribution of males and females at three sampling sites.** "bonbs" is  the sampling site consisting of lowland black spruce, "bonmat" or Bonanza Mature is a forested area filled with mature tree species. "bonrip" or Bonanza Riparian is the flood zone from the Tanana River.NA represents individuals with unidentified sex.

### As seen in Figures 2, juvenile male hares have an greater average weight than females. In addition, the weights across the three locations show similar trends.However, there is the greatest difference in average weight in the Bonanza Mature sample population. The Bonanaza Riparian zone has the greatest number of sample points and thus has that largest variation in hare weights. 


##### Table 1: **Summary stastics for juvenile snowshoe hares.** NA values for weight for a specific sex were excluded. NA values in table represent individual hares with unknown sex.
```{r}
juvenile_summary <- juvenile %>% 
  group_by(sex) %>% 
  summarize(mean_weight = mean(weight,na.rm=T),
            sd_weight = sd(weight, na.rm=T),
            sample_size = n())
kbl(juvenile_summary) %>% 
  kable_styling()
```

The actual difference in male and female average weight is 90.468 grams. This is a percent difference of 10.05% between the two sexes. The t-test comparison of the difference in mean weight of male and female hares resulted in a p-value of 0.007. This means that there is a 0.7% chance of taking random samples from populations with the same mean and finding sample means as different as those found here. The Cohen's D test indicates that the effect size is small.  

```{r, include= FALSE}
ggplot(juvenile, aes(sample = weight))+
  geom_qq()
```


```{r}
juvenile_f <- juvenile %>% 
  filter(sex == "f") %>% 
  pull(weight)

juvenile_f <- na.omit(juvenile_f)

juvenile_m <- juvenile %>% 
  filter(sex == "m") %>% 
  pull(weight)

juvenile_ttest <- t.test(juvenile_m, juvenile_f)
juvenile_ttest

cohen.d(juvenile_m, juvenile_f)
```

### Exploring the relationship between juvenile weight and hind foot length


```{r}
juveniles_lm <- lm(weight ~ hindft, data = juvenile)
summary(juveniles_lm)
plot(juveniles_lm)
```

```{r}
ggplot(data = juvenile, aes(x = hindft, y = weight))+
  geom_point(size = 2)+
  geom_smooth(method = "lm",
              color = "goldenrod3",
              size = 0.5,
              fill = "gray10",
              alpha = 0.5)+
  theme_bw()+
  ggpubr::stat_regline_equation(label.x = 110, label.y = 2000)+
  labs(x = "Hind Foot Length (mm)", y = " Weight (grams)", title = "Relationship Between Juvenile Hind Foot Length and Weight")
```

##### **Figure 4: The relationship between juvenile weight and hind foot length in snowshoe hares.** Data from all three sampling sites were combined.


### Adding a linear model to the data finds a Mulitple R^2 value of 0.2988. This means that about 30% of the variance of juvenile weight is explained by juvenile hind foot length. The full equation for the linear model is weight = 9.5234*(hind foot length) + (-279.3419). The Pearson's test finds a weak correlation between hind foot length and weight (r= 0.547, t(247) = 10.26, p < 0.001). One assumption to be concerned with our data is homoscedasticity because there is variance among the amount that the points differ from the model. 

```{r}
juvenile_cor <- cor.test(juvenile$hindft, juvenile$weight)
```

